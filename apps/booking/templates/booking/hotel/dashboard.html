
<!-- =============================
  FILE: templates/booking/hotel/dashboard.html
  "PRO" Dashboard – minimal, elegante y rápido.
  Compatibilidad: extiende base_hotel, usa `destinos` y `slides` (json_script).
============================= -->
  {% extends "booking/hotel/base_hotel.html" %}
  {% load static %}
  {% load i18n %}
  
  {% block title %}TravelSYS — Hoteles destacados{% endblock %}
  
  {% block hotel_content %}
  {# ---------- ESTILOS FINOS (sin librerías extras) ---------- #}
  <style>
    /* Contenedor máximo y respiración */
    .page-wrap { max-width: 1440px; }
  
    /* HERO: altura controlada + efecto suave */
    .hero {
      height: 56vh; min-height: 420px; max-height: 680px;
      border-radius: 20px; overflow: hidden;
    }
    @media (max-width: 768px) { .hero { height: 48vh; min-height: 340px; } }
  
    .hero-img {
      width: 100%; height: 100%;
      object-fit: cover; object-position: center;
      transform: scale(1.06);
      transition: transform 800ms ease;
    }
    .hero:hover .hero-img { transform: scale(1.085); }
  
    .glass {
      background: linear-gradient(180deg, rgba(255,255,255,.68), rgba(255,255,255,.44));
      -webkit-backdrop-filter: blur(10px); backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,.35);
    }
    .dark .glass {
      background: linear-gradient(180deg, rgba(17,24,39,.72), rgba(17,24,39,.5));
      border-color: rgba(148,163,184,.25);
    }
  
    /* Tarjeta destino (ratio fijo) */
    .ratio-4-3 { position: relative; padding-top: 75%; }
    .ratio-4-3 > img, .ratio-4-3 > .ratio-content {
      position: absolute; inset: 0;
    }
  
    /* Snap scroller */
    .snap-x-mandatory { scroll-snap-type: x mandatory; }
    .snap-start { scroll-snap-align: start; }
  
    /* Botones circulares fantasma */
    .ghost {
      background: rgba(17,24,39,.55); color: white;
      border: 1px solid rgba(255,255,255,.35);
    }
    .ghost:hover { background: rgba(17,24,39,.72); }
  
    /* Tag sutil */
    .chip {
      font-size: 11px; line-height: 1;
      padding: .35rem .55rem; border-radius: 9999px;
      border: 1px solid rgba(148,163,184,.35);
    }
  </style>
  
  <div class="page-wrap mx-auto px-4 sm:px-6 lg:px-8 py-6 space-y-10">
  
    {# ===== HERO ===== #}
    {{ slides|json_script:"slides-data" }}
    <section x-data="proHero()" x-init="init()" class="hero relative shadow-xl">
      <!-- Imagen -->
      <template x-for="(slide, i) in items" :key="i">
        <img x-show="index===i"
             :src="slide.image"
             :alt="slide.alt || slide.title"
             class="hero-img absolute inset-0"
             loading="eager" decoding="async">
      </template>
  
      <!-- Degradé para legibilidad -->
      <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/25 to-transparent"></div>
  
      <!-- Contenido -->
      <div class="absolute inset-x-0 bottom-0 p-5 sm:p-7 md:p-8">
        <div class="glass rounded-2xl p-4 sm:p-5 md:p-6 max-w-3xl text-white">
          <div class="flex items-center gap-2 mb-2">
            <span class="chip bg-white/10 text-white/90">
              <i class="fas fa-bolt mr-1"></i> {% trans "Destacado" %}
            </span>
            <span class="chip bg-white/10 text-white/90" x-text="items[index]?.badge || 'TravelSYS'"></span>
          </div>
          <h1 class="text-2xl sm:text-3xl md:text-4xl font-extrabold" x-text="items[index]?.title || 'TravelSYS'"></h1>
          <p class="mt-1 text-sm sm:text-base text-white/90" x-text="items[index]?.caption || '{{ _('Encuentra el destino perfecto con tarifas increíbles.') }}'"></p>
          <div class="mt-4 flex flex-wrap gap-2">
            <a :href="items[index]?.cta || '{% url 'booking:hotel_results' %}'"
               class="inline-flex items-center gap-2 bg-white text-gray-900 hover:bg-gray-100 font-semibold rounded-full px-4 py-2 text-sm">
              <i class="fas fa-search"></i> {% trans "Buscar hoteles" %}
            </a>
            <a href="{% url 'booking:hotel_results' %}?destino=todos-los-destinos"
               class="inline-flex items-center gap-2 ghost rounded-full px-4 py-2 text-sm">
              <i class="fas fa-compass"></i> {% trans "Explorar destinos" %}
            </a>
          </div>
        </div>
      </div>
  
      <!-- Controles -->
      <button @click="prev" aria-label="{% trans 'Anterior' %}"
              class="absolute left-3 top-1/2 -translate-y-1/2 hidden sm:inline-flex ghost rounded-full p-3">
        <i class="fas fa-chevron-left"></i>
      </button>
      <button @click="next" aria-label="{% trans 'Siguiente' %}"
              class="absolute right-3 top-1/2 -translate-y-1/2 hidden sm:inline-flex ghost rounded-full p-3">
        <i class="fas fa-chevron-right"></i>
      </button>
  
      <!-- Dots -->
      <div class="absolute bottom-4 left-1/2 -translate-x-1/2 flex items-center gap-2">
        <template x-for="(slide, i) in items" :key="'dot-'+i">
          <button @click="go(i)"
                  class="w-2.5 h-2.5 rounded-full border border-white/60"
                  :class="index===i ? 'bg-white' : 'bg-white/30 hover:bg-white/60'"
                  :aria-current="index===i"></button>
        </template>
      </div>
    </section>
  
    {# ===== ATAJOS / CATEGORÍAS ===== #}
    <section class="grid grid-cols-2 sm:grid-cols-4 gap-3 sm:gap-4">
      <a href="{% url 'booking:hotel_results' %}" class="glass rounded-xl px-4 py-3 flex items-center gap-3 hover:ring-2 ring-blue-500 transition">
        <span class="h-9 w-9 rounded-lg bg-blue-600 text-white grid place-items-center">
          <i class="fas fa-umbrella-beach"></i>
        </span>
        <div>
          <p class="text-sm font-semibold">{% trans "Playa" %}</p>
          <p class="text-[12px] text-gray-500 dark:text-gray-400">{% trans "Sol & arena" %}</p>
        </div>
      </a>
      <a href="{% url 'booking:hotel_results' %}" class="glass rounded-xl px-4 py-3 flex items-center gap-3 hover:ring-2 ring-emerald-500 transition">
        <span class="h-9 w-9 rounded-lg bg-emerald-600 text-white grid place-items-center">
          <i class="fas fa-spa"></i>
        </span>
        <div>
          <p class="text-sm font-semibold">{% trans "Spa" %}</p>
          <p class="text-[12px] text-gray-500 dark:text-gray-400">{% trans "Relajación" %}</p>
        </div>
      </a>
      <a href="{% url 'booking:hotel_results' %}" class="glass rounded-xl px-4 py-3 flex items-center gap-3 hover:ring-2 ring-indigo-500 transition">
        <span class="h-9 w-9 rounded-lg bg-indigo-600 text-white grid place-items-center">
          <i class="fas fa-utensils"></i>
        </span>
        <div>
          <p class="text-sm font-semibold">{% trans "Todo incluido" %}</p>
          <p class="text-[12px] text-gray-500 dark:text-gray-400">{% trans "Comidas & bebidas" %}</p>
        </div>
      </a>
      <a href="{% url 'booking:hotel_results' %}" class="glass rounded-xl px-4 py-3 flex items-center gap-3 hover:ring-2 ring-cyan-500 transition">
        <span class="h-9 w-9 rounded-lg bg-cyan-600 text-white grid place-items-center">
          <i class="fas fa-city"></i>
        </span>
        <div>
          <p class="text-sm font-semibold">{% trans "Ciudad" %}</p>
          <p class="text-[12px] text-gray-500 dark:text-gray-400">{% trans "Urbano" %}</p>
        </div>
      </a>
    </section>
  
    {# ===== EXPLORA POR DESTINO ===== #}
    <section class="space-y-3">
      <div class="flex items-center justify-between">
        <h2 class="text-xl font-bold">{% trans "Explora por destino" %}</h2>
        <a href="{% url 'booking:hotel_results' %}" class="text-blue-600 hover:text-blue-700 text-sm font-semibold">
          {% trans "Ver todos" %} <i class="fas fa-arrow-right text-xs"></i>
        </a>
      </div>
  
      <div class="grid grid-cols-2 md:grid-cols-4 xl:grid-cols-6 gap-4">
        {% if destinos %}
          {% for d in destinos|slice:":12" %}
            <a href="{% url 'booking:hotel_results' %}?destino={{ d.nombre|slugify }}"
               class="block rounded-xl overflow-hidden border border-gray-200 dark:border-gray-700 hover:shadow-lg transition">
              <div class="ratio-4-3">
                <img src="{{ d.foto_url }}"
                     alt="{{ d.nombre }}"
                     class="w-full h-full object-cover object-center">
                <div class="ratio-content bg-gradient-to-t from-black/70 via-black/10 to-transparent"></div>
                <div class="ratio-content flex items-end">
                  <span class="m-2 text-white text-sm font-semibold drop-shadow-sm">{{ d.nombre }}</span>
                </div>
              </div>
            </a>
          {% endfor %}
        {% else %}
          {% for i in "123456" %}
            <div class="rounded-xl overflow-hidden border border-gray-200 dark:border-gray-700">
              <div class="ratio-4-3">
                <img src="{% static 'backoffice/fotos_hoteles/gran_memories_santa_maria.jpeg' %}"
                     alt="{% trans 'Destino' %} {{ forloop.counter }}"
                     class="w-full h-full object-cover object-center">
                <div class="ratio-content bg-gradient-to-t from-black/70 via-black/10 to-transparent"></div>
                <div class="ratio-content flex items-end">
                  <span class="m-2 text-white text-sm font-semibold drop-shadow-sm">{% trans 'Destino' %} {{ forloop.counter }}</span>
                </div>
              </div>
            </div>
          {% endfor %}
        {% endif %}
      </div>
    </section>
  
    {# ===== CARRUSEL "MEJOR VALORADOS" (DEMO) ===== #}
    <section class="space-y-3">
      <div class="flex items-center justify-between">
        <h2 class="text-xl font-bold">{% trans "Mejor valorados" %}</h2>
        <div class="flex gap-2">
          <button type="button" class="ghost rounded-full p-2" @click="$refs.top.scrollBy({left:-320,behavior:'smooth'})">
            <i class="fas fa-chevron-left"></i>
          </button>
          <button type="button" class="ghost rounded-full p-2" @click="$refs.top.scrollBy({left:320,behavior:'smooth'})">
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
      </div>
  
      <div class="overflow-x-auto snap-x-mandatory" x-ref="top">
        <div class="flex gap-4">
          {% for i in "12345678" %}
            <a href="{% url 'booking:hotel_results' %}"
               class="snap-start min-w-[260px] bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl overflow-hidden hover:shadow-lg transition">
              <div class="relative h-40">
                <img src="{% static 'backoffice/fotos_hoteles/iberostar_grand_packard.jpeg' %}"
                     alt="{% trans 'Hotel destacado' %}" class="w-full h-full object-cover">
                <span class="chip absolute top-2 left-2 bg-white/85 text-gray-800 dark:bg-gray-900/80 dark:text-gray-100">
                  ★★★★★
                </span>
              </div>
              <div class="p-3">
                <h3 class="font-semibold text-sm leading-tight">{% trans "Iberostar Packard" %}</h3>
                <p class="text-[12px] text-gray-500">{% trans "La Habana, Cuba" %}</p>
                <div class="mt-2 flex items-center justify-between">
                  <span class="text-blue-700 dark:text-blue-400 font-bold">$ 199 <span class="text-xs font-normal">/ppn</span></span>
                  <span class="text-[12px] text-gray-500">{% trans "No reembolsable" %}</span>
                </div>
              </div>
            </a>
          {% endfor %}
        </div>
      </div>
    </section>
  
  </div>
  
  {# ---------- SCRIPT HERO (Alpine.js) ---------- #}
  <script>
  function proHero(){
    return {
      items: [],
      index: 0,
      timer: null,
      interval: 5500,
      init(){
        // Slides desde backend o fallback
        try {
          const raw = document.getElementById('slides-data')?.textContent || '[]';
          this.items = JSON.parse(raw);
        } catch(_) { this.items = []; }
        if (!Array.isArray(this.items) || !this.items.length){
          this.items = [
            {
              image: "{% static 'backoffice/fotos_hoteles/gran_memories_santa_maria.jpeg' %}",
              title: "TravelSYS",
              caption: "{% trans 'Explora destinos increíbles con las mejores tarifas.' %}",
              alt: "Playa tropical al atardecer", badge: "Top", cta: "{% url 'booking:hotel_results' %}"
            }
          ];
        }
        // Respeta "reduce motion"
        if (!window.matchMedia || !window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
          this.play();
        }
      },
      play(){ this.stop(); this.timer = setInterval(()=>this.next(), this.interval); },
      stop(){ if (this.timer) { clearInterval(this.timer); this.timer=null; } },
      next(){ this.index = (this.index + 1) % this.items.length; },
      prev(){ this.index = (this.index === 0) ? this.items.length - 1 : this.index - 1; },
      go(i){ if (i>=0 && i<this.items.length) this.index = i; }
    }
  }
  </script>
  {% endblock hotel_content %}