<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Voucher de Reserva – Hotel</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    /* ================================
       Ajustes generales y de impresión
       ================================ */
    :root {
      --azul: #1e3a8a;     /* blue-900 */
      --azul-50: #eff6ff;  /* blue-50  */
      --verde-50: #ecfdf5; /* emerald-50 */
      --gris-borde: #d1d5db;/* gray-300 */
    }

    /* Evita cortes feos en impresión */
    .no-break { break-inside: avoid; page-break-inside: avoid; }
    .print-hidden { display: none; }

    @media print {
      @page {
        size: letter;
        margin: 0.5in;
      }
      body {
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
        color-adjust: exact !important;
      }
      .print\:show { display: block !important; }
      .print\:hide { display: none !important; }
      .shadow, .shadow-md, .shadow-lg, .shadow-xl, .shadow-2xl { box-shadow: none !important; }
      .ring, .ring-1, .ring-2, .ring-4, .border { border-color: var(--gris-borde) !important; }
    }

    /* Logo circular consistente en pantalla e impresión */
    .logo-circle {
      width: 64px; height: 64px;
      border-radius: 9999px;
      border: 2px solid rgba(30,58,138,.15);
      display: grid; place-items: center;
      overflow: hidden;
      background: white;
    }

    /* Títulos de sección con subrayado sutil */
    .section-title {
      position: relative;
      padding-bottom: .25rem;
    }
    .section-title:after {
      content: "";
      position: absolute;
      left: 0; bottom: 0;
      width: 100%;
      height: 2px;
      background: linear-gradient(90deg, rgba(30,58,138,.35), rgba(30,58,138,0));
    }

    /* Chips/resumen */
    .kpi-card { background: #fff; border: 1px solid var(--gris-borde); border-radius: .75rem; }

    /* Color de secciones claras */
    .bg-azul-50 { background: var(--azul-50); }
    .bg-verde-50 { background: var(--verde-50); }

    /* Iconos genéricos */
    .icon { width: 18px; height: 18px; display: inline-block; vertical-align: middle; }
  </style>
</head>
<body class="min-h-screen bg-gray-50 p-4 print:p-0 flex items-start justify-center">
  <!-- Contenedor tamaño carta -->
  <div class="w-full max-w-[8.5in] bg-white border border-gray-300 rounded-2xl shadow-lg overflow-hidden">

    <!-- Barra superior de acciones (solo pantalla) -->
    <div class="p-3 flex items-center justify-end gap-2 print:hide">
      <button onclick="window.print()" class="px-4 py-2 text-sm font-semibold rounded-full border border-gray-300 hover:bg-gray-50 transition">
        Imprimir / Guardar PDF
      </button>
    </div>

    <!-- Encabezado -->
    <header class="bg-azul-50 px-6 py-6 border-y border-blue-100">
      <div class="flex items-start justify-between gap-6">
        <!-- Marca & Hotel -->
        <div class="flex items-start gap-4">
          <div class="logo-circle shadow-sm">
            <!-- Si tienes logo: <img src="{{ url_static_logo }}" alt="Ruta Multiservice" class="w-full h-full object-cover"/> -->
            <svg viewBox="0 0 24 24" class="icon text-blue-700">
              <circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="2"/>
              <path d="M7 13l3 3 7-7" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </div>
          <div>
            <h1 class="text-3xl font-extrabold tracking-tight text-blue-900 leading-8">
              {{ hotel_nombre }}
            </h1>
            <p class="text-sm text-gray-700 mt-1 flex items-start gap-2">
              <svg class="w-4 h-4 text-blue-700 mt-0.5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 21s-6-5.686-6-10a6 6 0 1112 0c0 4.314-6 10-6 10z"/><circle cx="12" cy="11" r="3"/>
              </svg>
              <span>{{ hotel_direccion }}</span>
            </p>
            {% if hotel_telefono %}
            <p class="text-xs text-gray-600 mt-1">
              Tel: {{ hotel_telefono }} &nbsp;|&nbsp; Email: info@rutamultiservice.com
            </p>
            {% endif %}
          </div>
        </div>

        <!-- Caja de voucher -->
        <div class="text-right bg-white border border-blue-200 rounded-xl px-4 py-3 shadow">
          <p class="text-xs font-semibold text-blue-800 uppercase tracking-wide">Voucher Confirmado</p>
          <p class="text-xs text-gray-700 mt-1">Reserva: <span class="font-bold">{{ reserva.id }}</span></p>
          <p class="text-xs text-gray-700">Confirmación: <span class="font-bold">{{ reserva.numero_confirmacion }}</span></p>
          {% if reserva.booking_code %}
          <p class="text-xs text-gray-700">Booking Code: <span class="font-semibold">{{ reserva.booking_code }}</span></p>
          {% endif %}
          {% if reserva.proveedor %}
          <p class="text-[11px] text-gray-600 mt-1">Proveedor: <span class="font-medium">{{ reserva.proveedor.nombre|default:"-" }}</span></p>
          {% endif %}
        </div>
      </div>
    </header>

    <!-- Cuerpo -->
    <main class="p-6 space-y-6">

      <!-- Resumen -->
      <section class="bg-verde-50 border border-emerald-200 rounded-xl p-4 no-break">
        <h2 class="section-title text-base font-bold text-gray-900 mb-3">RESUMEN DE LA RESERVA</h2>
        <div class="grid grid-cols-2 sm:grid-cols-4 gap-3">
          <!-- Check-in -->
          <div class="kpi-card p-3 text-center">
            <svg class="w-5 h-5 mx-auto mb-1 text-emerald-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="4" width="18" height="18" rx="2"/><path d="M16 2v4M8 2v4M3 10h18"/>
            </svg>
            <p class="text-[11px] font-semibold text-gray-600">CHECK-IN</p>
            <p class="text-sm font-bold text-gray-900">{{ fechas_checkin }}</p>
            <p class="text-[11px] text-gray-600">Desde 15:00</p>
          </div>

          <!-- Check-out -->
          <div class="kpi-card p-3 text-center">
            <svg class="w-5 h-5 mx-auto mb-1 text-emerald-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="4" width="18" height="18" rx="2"/><path d="M16 2v4M8 2v4M3 10h18"/>
            </svg>
            <p class="text-[11px] font-semibold text-gray-600">CHECK-OUT</p>
            <p class="text-sm font-bold text-gray-900">{{ fechas_checkout }}</p>
            <p class="text-[11px] text-gray-600">Hasta 12:00</p>
          </div>

          <!-- Habitaciones -->
          <div class="kpi-card p-3 text-center">
            <svg class="w-5 h-5 mx-auto mb-1 text-emerald-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 10h18M5 10v8m14-8v8M7 13h3m4 0h3"/>
            </svg>
            <p class="text-[11px] font-semibold text-gray-600">HABITACIONES</p>
            <p class="text-sm font-bold text-gray-900">{{ habitaciones|length }}</p>
            <p class="text-[11px] text-gray-600">{{ noches_reserva }} noches</p>
          </div>

          <!-- Huéspedes -->
          <div class="kpi-card p-3 text-center">
            <svg class="w-5 h-5 mx-auto mb-1 text-emerald-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="9" cy="7" r="4"/><path d="M17 11a3 3 0 110-6 3 3 0 010 6z"/><path d="M2 21v-2a7 7 0 017-7h0a7 7 0 017 7v2"/>
            </svg>
            <p class="text-[11px] font-semibold text-gray-600">HUÉSPEDES</p>
            <p class="text-sm font-bold text-gray-900">{{ pasajeros|length }}</p>
            <p class="text-[11px] text-gray-600">Total</p>
          </div>
        </div>

        <!-- Info extra opcional -->
        <div class="grid grid-cols-1 sm:grid-cols-3 gap-3 mt-3">
          {% if plan_alimenticio %}
          <div class="kpi-card p-3">
            <p class="text-[11px] font-semibold text-gray-600">Plan</p>
            <p class="text-sm font-bold text-gray-900">{{ plan_alimenticio }}</p>
          </div>
          {% endif %}
          {% if tarifa_nombre %}
          <div class="kpi-card p-3">
            <p class="text-[11px] font-semibold text-gray-600">Tarifa</p>
            <p class="text-sm font-bold text-gray-900">{{ tarifa_nombre }}</p>
          </div>
          {% endif %}
          {% if total_reserva and moneda %}
          <div class="kpi-card p-3">
            <p class="text-[11px] font-semibold text-gray-600">Total</p>
            <p class="text-sm font-bold text-gray-900">{{ total_reserva }} {{ moneda }}</p>
          </div>
          {% endif %}
        </div>
      </section>

      <!-- Detalles de habitaciones y huéspedes -->
      <section class="no-break">
        <h2 class="section-title text-base font-bold text-gray-900 mb-3">
          DETALLES DE HABITACIONES Y HUÉSPEDES
        </h2>

        <div class="space-y-4">
          {% for h in habitaciones %}
          <article class="border border-gray-300 rounded-xl overflow-hidden no-break">
            <!-- Cabecera habitación -->
            <div class="bg-yellow-50 border-b border-yellow-200 px-4 py-2 flex items-center justify-between">
              <div class="flex items-center gap-2">
                <svg class="w-4 h-4 text-yellow-700" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"/>
                  <path d="M8 15v-4a2 2 0 114 0v4"/>
                </svg>
                <h3 class="text-sm font-bold text-gray-900">
                  {{ h.habitacion_nombre|default:"Habitación" }}
                </h3>
              </div>
              <div class="text-right">
                <p class="text-sm font-semibold text-gray-900">{{ h.tipo_habitacion|default:"Tipo no especificado" }}</p>
                {% if h.camas %}<p class="text-xs text-gray-600">{{ h.camas }}</p>{% endif %}
              </div>
            </div>

            <!-- Huéspedes -->
            <div class="bg-gray-50 px-4 py-3">
              <h4 class="text-xs font-semibold text-gray-800 mb-2 flex items-center gap-1">
                <svg class="w-3.5 h-3.5 text-gray-700" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="9" cy="7" r="4"/><path d="M17 11a3 3 0 110-6 3 3 0 010 6z"/><path d="M2 21v-2a7 7 0 017-7h0a7 7 0 017 7v2"/>
                </svg>
                Huéspedes ({{ h.pasajeros.all|length }})
              </h4>

              <div class="grid grid-cols-1 lg:grid-cols-2 gap-2">
                {% for p in h.pasajeros.all %}
                <div class="bg-white border border-gray-200 rounded-lg p-3 no-break">
                  <div class="grid grid-cols-2 md:grid-cols-4 gap-2 text-xs">
                    <div>
                      <p class="font-semibold text-gray-600 uppercase">Nombre</p>
                      <p class="font-semibold text-gray-900 break-words">{{ p.nombre }}</p>
                    </div>
                    <div>
                      <p class="font-semibold text-gray-600 uppercase">Documento</p>
                      <p class="font-medium text-gray-900">{{ p.pasaporte|default:"-" }}</p>
                    </div>
                    <div>
                      <p class="font-semibold text-gray-600 uppercase">Teléfono</p>
                      <p class="font-medium text-gray-900">{{ p.telefono|default:"-" }}</p>
                    </div>
                    <div>
                      <p class="font-semibold text-gray-600 uppercase">Email</p>
                      <p class="font-medium text-gray-900 break-all">{{ p.email|default:"-" }}</p>
                    </div>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>
          </article>
          {% endfor %}
        </div>
      </section>

      <!-- Información importante / Políticas -->
      <section class="border-t border-gray-200 pt-4 no-break">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <h3 class="text-sm font-bold text-gray-900 mb-2">INFORMACIÓN IMPORTANTE</h3>
            <ul class="text-xs text-gray-700 space-y-1 leading-5">
              <li>• Presenta este voucher al momento del check-in.</li>
              <li>• Check-in: 15:00 | Check-out: 12:00.</li>
              <li>• Documento de identidad válido para todos los huéspedes.</li>
              {% if politicas_cancelacion %}
              <li>• Cancelación: {{ politicas_cancelacion }}</li>
              {% else %}
              <li>• Cancelación sin cargo hasta 24 h antes.</li>
              {% endif %}
              <li>• Soporte Ruta Multiservice: +1 786 499 0612 • info@rutamultiservice.com</li>
            </ul>
          </div>

          <div class="bg-gray-50 border border-gray-200 rounded-lg p-3">
            <h3 class="text-sm font-bold text-gray-900 mb-2">DATOS DE LA AGENCIA</h3>
            <p class="text-xs text-gray-700 leading-5">
              Ruta Multiservice<br/>
              6915 W Flagler St, Miami, FL 33144<br/>
              Tel: +1 786 499 0612 • info@rutamultiservice.com
            </p>
          </div>
        </div>
      </section>

      <!-- Pie -->
      <section class="text-center border-t border-gray-200 pt-3 no-break">
        <p class="text-[11px] text-gray-600">
          Voucher generado el <span id="current-date"></span> — Confirmación #{{ reserva.numero_confirmacion }}
        </p>
      </section>
    </main>
  </div>

  <script>
    document.getElementById('current-date').textContent =
      new Date().toLocaleDateString('es-ES', { year: 'numeric', month: '2-digit', day: '2-digit' });
  </script>
</body>
</html>
